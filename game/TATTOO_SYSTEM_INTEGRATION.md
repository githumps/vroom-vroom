# Prison Tattoo System - Integration Guide

## Overview
Complete prison tattoo system with:
- 10x10 grid drawing tool
- Multi-step process (Design → Stencil → Ink → Care)
- 25% infection chance
- Permanent tattoo storage
- Tattoo collection display

## Files Created
1. `tattoo-system.js` - TattooSystem class (already created)
2. This integration guide

## Integration Steps

### STEP 1: Add HTML Screen to index.html

Add this TATTOO STUDIO screen after the EATING SIMULATOR and before the PRISON LIBRARY:

```html
        <!-- TATTOO STUDIO -->
        <div id="tattooStudio" class="screen">
            <h2>PRISON TATTOO PARLOR</h2>
            <p style="margin: 20px; font-size: 1.1em; color: #ff0;">WARNING: Tattoos are permanent. Risk of infection: 25%</p>

            <div class="form-container" style="max-width: 900px;">
                <!-- Tattoo Collection Display -->
                <div id="tattooCollection" style="margin-bottom: 30px; padding: 20px; border: 2px solid #0f0;">
                    <h3 style="color: #0f0; margin-bottom: 15px;">YOUR TATTOOS</h3>
                    <div id="tattooList" style="color: #0f0;">
                        No tattoos yet. Design your first one below.
                    </div>
                </div>

                <!-- Current State -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #0f0; margin-bottom: 10px;">STEP: <span id="tattooStep">DESIGN</span></h3>
                    <p style="color: #0f0; font-size: 1.1em;" id="tattooInstructions">Click cells to draw your tattoo design (10x10 grid)</p>
                </div>

                <!-- Drawing Canvas -->
                <div style="display: flex; justify-content: center; margin-bottom: 20px;">
                    <div id="tattooCanvas" style="display: inline-grid; grid-template-columns: repeat(10, 30px); gap: 2px; background: #000; padding: 10px; border: 2px solid #0f0;">
                        <!-- Grid cells generated by JavaScript -->
                    </div>
                </div>

                <!-- Preview -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #0f0; margin-bottom: 10px;">PREVIEW</h3>
                    <pre id="tattooPreview" style="font-size: 1.2em; line-height: 1.2em; color: #0f0; background: #000; padding: 15px; border: 1px solid #0f0; display: inline-block;">                    </pre>
                </div>

                <!-- Action Buttons -->
                <div style="text-align: center;">
                    <button id="clearButton" onclick="game.clearTattooDesign()">CLEAR DESIGN</button>
                    <button id="stencilButton" onclick="game.createStencil()">CREATE STENCIL</button>
                    <button id="inkButton" onclick="game.applyInk()" style="display: none;">APPLY INK</button>
                    <button id="careButton" onclick="game.startCareGame()" style="display: none;">CARE FOR TATTOO</button>
                    <button id="backButton" onclick="game.cancelTattoo()">BACK TO MENU</button>
                </div>

                <!-- Infection Status -->
                <div id="infectionStatus" style="display: none; margin-top: 20px; padding: 15px; border: 2px solid #f00; background: rgba(255, 0, 0, 0.1);">
                    <h3 style="color: #f00; text-align: center;">INFECTION DETECTED!</h3>
                    <p style="color: #f00; text-align: center;">Your tattoo is infected. You feel sick. This was a bad idea.</p>
                </div>

                <!-- Care Mini-Game -->
                <div id="careGame" style="display: none; margin-top: 20px; padding: 20px; border: 2px solid #ff0; background: rgba(255, 255, 0, 0.05);">
                    <h3 style="color: #ff0; text-align: center; margin-bottom: 15px;">TATTOO AFTERCARE</h3>
                    <p style="color: #0f0; text-align: center; margin-bottom: 20px;">Clean the tattoo to prevent infection. Click the correct sequence!</p>
                    <div id="careSequence" style="display: flex; justify-content: center; gap: 10px; margin-bottom: 20px;">
                        <button onclick="game.careAction('clean')" style="background: #003300;">CLEAN</button>
                        <button onclick="game.careAction('bandage')" style="background: #333300;">BANDAGE</button>
                        <button onclick="game.careAction('ignore')" style="background: #330000;">IGNORE</button>
                    </div>
                    <div id="careProgress" style="color: #0f0; text-align: center; font-size: 1.1em;">Progress: <span id="careScore">0</span>/3</div>
                </div>
            </div>
        </div>
```

### STEP 2: Add script tag to index.html

Add this line BEFORE the closing `</body>` tag, after the other script tags:

```html
    <script src="tattoo-system.js"></script>
    <script src="game.js"></script>
</body>
```

### STEP 3: Initialize TattooSystem in game.js

In the `VroomVroomGame` constructor (around line 629), add:

```javascript
// Initialize Sound System
this.soundSystem = new SoundSystem();

// Initialize Tattoo System
this.tattooSystem = null; // Initialized on first use

this.init();
```

### STEP 4: Add tattoo system methods to game.js

Add these methods to the `VroomVroomGame` class (after the `sendLetter()` method, around line 1680):

```javascript
// ============================================================
// TATTOO SYSTEM METHODS
// ============================================================

// Initialize tattoo system (lazy initialization)
initTattooSystem() {
    if (!this.tattooSystem) {
        this.tattooSystem = new TattooSystem(this);
    }
    this.tattooSystem.initializeTattooStudio();
}

// Clear tattoo design
clearTattooDesign() {
    if (this.tattooSystem) {
        this.tattooSystem.clearDesign();
    }
}

// Create stencil
createStencil() {
    if (this.tattooSystem) {
        this.tattooSystem.createStencil();
    }
}

// Apply ink
applyInk() {
    if (this.tattooSystem) {
        this.tattooSystem.applyInk();
    }
}

// Start care game
startCareGame() {
    if (this.tattooSystem) {
        this.tattooSystem.startCareGame();
    }
}

// Care action
careAction(action) {
    if (this.tattooSystem) {
        this.tattooSystem.careAction(action);
    }
}

// Cancel tattoo
cancelTattoo() {
    if (this.tattooSystem) {
        this.tattooSystem.cancel();
    }
}
```

### STEP 5: Update prisonActivity() method

In the `prisonActivity()` method (around line 1647), UPDATE the tattoo activity handling:

```javascript
if (activity === 'weights') {
    this.showScreen('weightLifting');
    this.initializeWeightLifting();
    return; // Don't add prison day yet, handled in workout completion
} else if (activity === 'letter') {
    this.showScreen('letterWriting');
} else if (activity === 'read') {
    this.showScreen('prisonLibrary');
    this.updateLibraryScreen();
} else if (activity === 'tattoo') {
    // NEW: Show tattoo studio screen
    this.showScreen('tattooStudio');
    this.initTattooSystem();
    return; // Don't add prison day yet, handled in tattoo completion
} else if (activity === 'commissary') {
    this.showScreen('commissaryShop');
    this.updateCommissaryScreen();
    return;
} else {
    const msg = messages[activity][Math.floor(Math.random() * messages[activity].length)];
    this.showMessage(msg, 4000);
}

// REMOVE OLD CODE:
// if (activity === 'tattoo') {
//     this.player.tattoos.push('Prison Tattoo #' + (this.player.tattoos.length + 1));
// }
```

### STEP 6: Update player.tattoos structure

The tattoo system uses a different tattoo structure. The existing code:
```javascript
player.tattoos = []  // Old: just strings
```

Now stores:
```javascript
player.tattoos = [
    {
        design: [[0,1,0...], [1,1,1...], ...],  // 10x10 grid
        timestamp: 1234567890,
        infected: false
    }
]
```

This is backward compatible - old saves will still work.

## Testing

1. Start game and get sent to prison
2. Click "GET PRISON TATTOO"
3. Draw a design by clicking cells in the 10x10 grid
4. Click "CREATE STENCIL" (locks design)
5. Click "APPLY INK" (makes permanent)
6. Play the care mini-game:
   - Correct sequence: CLEAN → BANDAGE → CLEAN
   - Wrong actions restart the sequence
7. After care game completes:
   - 25% chance of infection
   - Tattoo is saved to profile
   - Can see tattoos in "YOUR TATTOOS" section
   - System resets for new tattoo

## Features

- **10x10 Grid Drawing**: Click cells to toggle black/white
- **ASCII Preview**: Real-time preview of your design
- **Multi-Step Process**:
  1. DESIGN: Draw your tattoo
  2. STENCIL: Lock the design
  3. INK: Make it permanent
  4. CARE: Mini-game to prevent infection
- **Infection Risk**: 25% chance after care game
- **Permanent Storage**: All tattoos saved to profile
- **Tattoo Collection**: View all your tattoos with dates and infection status

## Game Integration

The tattoo activity:
- Does NOT advance prison days automatically
- Only advances prison day when tattoo is COMPLETE
- Player can design multiple tattoos
- Each tattoo takes 1 prison day
- Infected tattoos are marked with [INFECTED] status

## Files Modified

1. `game/index.html` - Add tattooStudio screen + script tag
2. `game/game.js` - Add tattoo system methods + update prisonActivity
3. `game/tattoo-system.js` - NEW FILE (already created)

## Complete!

The prison tattoo system is now fully integrated into VROOM VROOM.
